include         /usr/local/etc/openldap/schema/core.schema
include         /usr/local/etc/openldap/schema/cosine.schema
include         /usr/local/etc/openldap/schema/inetorgperson.schema
include         /usr/local/etc/openldap/schema/nis.schema
include         /usr/local/etc/openldap/schema/esmile.schema
include         /usr/local/etc/openldap/schema/samba.schema
include         /usr/local/etc/openldap/schema/emmailaux.schema

pidfile         /usr/local/var/run/slapd.pid
argsfile        /usr/local/var/run/slapd.args

modulepath      /usr/local/libexec/openldap
moduleload      back_mdb.la

access to dn.base="" by * read
access to dn.base="cn=Subschema" by * read
access to *
    by dn.exact="cn=admin,dc=e-smile,dc=ne,dc=jp" write
    by dn.exact="gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth" write
    by self write
    by group.exact="cn=ldapusers,ou=Groups,dc=e-smile,dc=ne,dc=jp" read
    by users read
    by anonymous auth

database        mdb
maxsize         1073741824
directory       /usr/local/var/openldap-data
suffix          "dc=e-smile,dc=ne,dc=jp"
rootdn          "cn=admin,dc=e-smile,dc=ne,dc=jp"
rootpw          {SSHA}NjGmWJPN6awr3upV1dUgUvLrDSI2U9l5

index           objectClass     eq

access to attrs=userPassword,shadowLastChange,shadowWarning,sambaNTPassword,sambaPwdLastSet
    by dn.exact="gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth" manage
    by dn.exact="cn=admin,dc=e-smile,dc=ne,dc=jp" write
    by self write
    by anonymous auth
    by * auth

access to dn.base=""
    by * read

access to *
    by dn.exact="gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth" write
    by dn.exact="cn=admin,dc=e-smile,dc=ne,dc=jp" write
    by self write
    by group.exact="cn=ldapusers,ou=Groups,dc=e-smile,dc=ne,dc=jp" read
    by users read
    by * read
    by anonymous auth

database        monitor

database config
rootdn "cn=config"
access to *
    by dn.exact="gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth" manage
    by * none
